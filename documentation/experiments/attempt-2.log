python3 ./tools/infer_kie_token_ser_re.py \
  -c configs/kie/vi_layoutxlm/re_vi_layoutxlm_xfund_zh.yml \
  -o Architecture.Backbone.checkpoints=./pretrained_model/re_vi_layoutxlm_xfund_pretrained/best_accuracy \
  Global.infer_img=../documentation/Invoice.png \
  Global.use_gpu=False \
  -c_ser configs/kie/vi_layoutxlm/ser_vi_layoutxlm_xfund_zh.yml \
  -o_ser Architecture.Backbone.checkpoints=./pretrained_model/ser_vi_layoutxlm_xfund_pretrained/best_accuracy
/home/axsae/.pyenv/versions/venv_paddle/lib/python3.8/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
/home/axsae/.pyenv/versions/venv_paddle/lib/python3.8/site-packages/skimage/util/dtype.py:27: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  np.bool8: (False, True),
[2023/02/24 16:39:04] ppocr INFO: ********** re config **********
[2023/02/24 16:39:04] ppocr INFO: Architecture : 
[2023/02/24 16:39:04] ppocr INFO:     Backbone : 
[2023/02/24 16:39:04] ppocr INFO:         checkpoints : ./pretrained_model/re_vi_layoutxlm_xfund_pretrained/best_accuracy
[2023/02/24 16:39:04] ppocr INFO:         mode : vi
[2023/02/24 16:39:04] ppocr INFO:         name : LayoutXLMForRe
[2023/02/24 16:39:04] ppocr INFO:         pretrained : True
[2023/02/24 16:39:04] ppocr INFO:     Transform : None
[2023/02/24 16:39:04] ppocr INFO:     algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:     model_type : kie
[2023/02/24 16:39:04] ppocr INFO: Eval : 
[2023/02/24 16:39:04] ppocr INFO:     dataset : 
[2023/02/24 16:39:04] ppocr INFO:         data_dir : train_data/XFUND/zh_val/image
[2023/02/24 16:39:04] ppocr INFO:         label_file_list : ['train_data/XFUND/zh_val/val.json']
[2023/02/24 16:39:04] ppocr INFO:         name : SimpleDataSet
[2023/02/24 16:39:04] ppocr INFO:         transforms : 
[2023/02/24 16:39:04] ppocr INFO:             DecodeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 channel_first : False
[2023/02/24 16:39:04] ppocr INFO:                 img_mode : RGB
[2023/02/24 16:39:04] ppocr INFO:             VQATokenLabelEncode : 
[2023/02/24 16:39:04] ppocr INFO:                 algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:                 class_path : train_data/XFUND/class_list_xfun.txt
[2023/02/24 16:39:04] ppocr INFO:                 contains_re : True
[2023/02/24 16:39:04] ppocr INFO:                 order_method : tb-yx
[2023/02/24 16:39:04] ppocr INFO:                 use_textline_bbox_info : True
[2023/02/24 16:39:04] ppocr INFO:             VQATokenPad : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:                 return_attention_mask : True
[2023/02/24 16:39:04] ppocr INFO:             VQAReTokenRelation : None
[2023/02/24 16:39:04] ppocr INFO:             VQAReTokenChunk : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:             TensorizeEntitiesRelations : None
[2023/02/24 16:39:04] ppocr INFO:             Resize : 
[2023/02/24 16:39:04] ppocr INFO:                 size : [224, 224]
[2023/02/24 16:39:04] ppocr INFO:             NormalizeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 mean : [123.675, 116.28, 103.53]
[2023/02/24 16:39:04] ppocr INFO:                 order : hwc
[2023/02/24 16:39:04] ppocr INFO:                 scale : 1
[2023/02/24 16:39:04] ppocr INFO:                 std : [58.395, 57.12, 57.375]
[2023/02/24 16:39:04] ppocr INFO:             ToCHWImage : None
[2023/02/24 16:39:04] ppocr INFO:             KeepKeys : 
[2023/02/24 16:39:04] ppocr INFO:                 keep_keys : ['input_ids', 'bbox', 'attention_mask', 'token_type_ids', 'entities', 'relations']
[2023/02/24 16:39:04] ppocr INFO:     loader : 
[2023/02/24 16:39:04] ppocr INFO:         batch_size_per_card : 8
[2023/02/24 16:39:04] ppocr INFO:         drop_last : False
[2023/02/24 16:39:04] ppocr INFO:         num_workers : 8
[2023/02/24 16:39:04] ppocr INFO:         shuffle : False
[2023/02/24 16:39:04] ppocr INFO: Global : 
[2023/02/24 16:39:04] ppocr INFO:     cal_metric_during_train : False
[2023/02/24 16:39:04] ppocr INFO:     epoch_num : 130
[2023/02/24 16:39:04] ppocr INFO:     eval_batch_step : [0, 19]
[2023/02/24 16:39:04] ppocr INFO:     infer_img : ../documentation/Invoice.png
[2023/02/24 16:39:04] ppocr INFO:     kie_det_model_dir : None
[2023/02/24 16:39:04] ppocr INFO:     kie_rec_model_dir : None
[2023/02/24 16:39:04] ppocr INFO:     log_smooth_window : 10
[2023/02/24 16:39:04] ppocr INFO:     print_batch_step : 10
[2023/02/24 16:39:04] ppocr INFO:     save_epoch_step : 2000
[2023/02/24 16:39:04] ppocr INFO:     save_inference_dir : None
[2023/02/24 16:39:04] ppocr INFO:     save_model_dir : ./output/re_vi_layoutxlm_xfund_zh
[2023/02/24 16:39:04] ppocr INFO:     save_res_path : ./output/re/xfund_zh/with_gt
[2023/02/24 16:39:04] ppocr INFO:     seed : 2022
[2023/02/24 16:39:04] ppocr INFO:     use_gpu : False
[2023/02/24 16:39:04] ppocr INFO:     use_visualdl : False
[2023/02/24 16:39:04] ppocr INFO: Loss : 
[2023/02/24 16:39:04] ppocr INFO:     key : loss
[2023/02/24 16:39:04] ppocr INFO:     name : LossFromOutput
[2023/02/24 16:39:04] ppocr INFO:     reduction : mean
[2023/02/24 16:39:04] ppocr INFO: Metric : 
[2023/02/24 16:39:04] ppocr INFO:     main_indicator : hmean
[2023/02/24 16:39:04] ppocr INFO:     name : VQAReTokenMetric
[2023/02/24 16:39:04] ppocr INFO: Optimizer : 
[2023/02/24 16:39:04] ppocr INFO:     beta1 : 0.9
[2023/02/24 16:39:04] ppocr INFO:     beta2 : 0.999
[2023/02/24 16:39:04] ppocr INFO:     clip_norm : 10
[2023/02/24 16:39:04] ppocr INFO:     lr : 
[2023/02/24 16:39:04] ppocr INFO:         learning_rate : 5e-05
[2023/02/24 16:39:04] ppocr INFO:         warmup_epoch : 10
[2023/02/24 16:39:04] ppocr INFO:     name : AdamW
[2023/02/24 16:39:04] ppocr INFO:     regularizer : 
[2023/02/24 16:39:04] ppocr INFO:         factor : 0.0
[2023/02/24 16:39:04] ppocr INFO:         name : L2
[2023/02/24 16:39:04] ppocr INFO: PostProcess : 
[2023/02/24 16:39:04] ppocr INFO:     name : VQAReTokenLayoutLMPostProcess
[2023/02/24 16:39:04] ppocr INFO: Train : 
[2023/02/24 16:39:04] ppocr INFO:     dataset : 
[2023/02/24 16:39:04] ppocr INFO:         data_dir : train_data/XFUND/zh_train/image
[2023/02/24 16:39:04] ppocr INFO:         label_file_list : ['train_data/XFUND/zh_train/train.json']
[2023/02/24 16:39:04] ppocr INFO:         name : SimpleDataSet
[2023/02/24 16:39:04] ppocr INFO:         ratio_list : [1.0]
[2023/02/24 16:39:04] ppocr INFO:         transforms : 
[2023/02/24 16:39:04] ppocr INFO:             DecodeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 channel_first : False
[2023/02/24 16:39:04] ppocr INFO:                 img_mode : RGB
[2023/02/24 16:39:04] ppocr INFO:             VQATokenLabelEncode : 
[2023/02/24 16:39:04] ppocr INFO:                 algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:                 class_path : train_data/XFUND/class_list_xfun.txt
[2023/02/24 16:39:04] ppocr INFO:                 contains_re : True
[2023/02/24 16:39:04] ppocr INFO:                 order_method : tb-yx
[2023/02/24 16:39:04] ppocr INFO:                 use_textline_bbox_info : True
[2023/02/24 16:39:04] ppocr INFO:             VQATokenPad : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:                 return_attention_mask : True
[2023/02/24 16:39:04] ppocr INFO:             VQAReTokenRelation : None
[2023/02/24 16:39:04] ppocr INFO:             VQAReTokenChunk : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:             TensorizeEntitiesRelations : None
[2023/02/24 16:39:04] ppocr INFO:             Resize : 
[2023/02/24 16:39:04] ppocr INFO:                 size : [224, 224]
[2023/02/24 16:39:04] ppocr INFO:             NormalizeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 mean : [123.675, 116.28, 103.53]
[2023/02/24 16:39:04] ppocr INFO:                 order : hwc
[2023/02/24 16:39:04] ppocr INFO:                 scale : 1
[2023/02/24 16:39:04] ppocr INFO:                 std : [58.395, 57.12, 57.375]
[2023/02/24 16:39:04] ppocr INFO:             ToCHWImage : None
[2023/02/24 16:39:04] ppocr INFO:             KeepKeys : 
[2023/02/24 16:39:04] ppocr INFO:                 keep_keys : ['input_ids', 'bbox', 'attention_mask', 'token_type_ids', 'entities', 'relations']
[2023/02/24 16:39:04] ppocr INFO:     loader : 
[2023/02/24 16:39:04] ppocr INFO:         batch_size_per_card : 2
[2023/02/24 16:39:04] ppocr INFO:         drop_last : False
[2023/02/24 16:39:04] ppocr INFO:         num_workers : 4
[2023/02/24 16:39:04] ppocr INFO:         shuffle : True
[2023/02/24 16:39:04] ppocr INFO: 

[2023/02/24 16:39:04] ppocr INFO: ********** ser config **********
[2023/02/24 16:39:04] ppocr INFO: Architecture : 
[2023/02/24 16:39:04] ppocr INFO:     Backbone : 
[2023/02/24 16:39:04] ppocr INFO:         checkpoints : ./pretrained_model/ser_vi_layoutxlm_xfund_pretrained/best_accuracy
[2023/02/24 16:39:04] ppocr INFO:         mode : vi
[2023/02/24 16:39:04] ppocr INFO:         name : LayoutXLMForSer
[2023/02/24 16:39:04] ppocr INFO:         num_classes : 7
[2023/02/24 16:39:04] ppocr INFO:         pretrained : True
[2023/02/24 16:39:04] ppocr INFO:     Transform : None
[2023/02/24 16:39:04] ppocr INFO:     algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:     model_type : kie
[2023/02/24 16:39:04] ppocr INFO: Eval : 
[2023/02/24 16:39:04] ppocr INFO:     dataset : 
[2023/02/24 16:39:04] ppocr INFO:         data_dir : train_data/XFUND/zh_val/image
[2023/02/24 16:39:04] ppocr INFO:         label_file_list : ['train_data/XFUND/zh_val/val.json']
[2023/02/24 16:39:04] ppocr INFO:         name : SimpleDataSet
[2023/02/24 16:39:04] ppocr INFO:         transforms : 
[2023/02/24 16:39:04] ppocr INFO:             DecodeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 channel_first : False
[2023/02/24 16:39:04] ppocr INFO:                 img_mode : RGB
[2023/02/24 16:39:04] ppocr INFO:             VQATokenLabelEncode : 
[2023/02/24 16:39:04] ppocr INFO:                 algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:                 class_path : train_data/XFUND/class_list_xfun.txt
[2023/02/24 16:39:04] ppocr INFO:                 contains_re : False
[2023/02/24 16:39:04] ppocr INFO:                 order_method : tb-yx
[2023/02/24 16:39:04] ppocr INFO:                 use_textline_bbox_info : True
[2023/02/24 16:39:04] ppocr INFO:             VQATokenPad : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:                 return_attention_mask : True
[2023/02/24 16:39:04] ppocr INFO:             VQASerTokenChunk : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:             Resize : 
[2023/02/24 16:39:04] ppocr INFO:                 size : [224, 224]
[2023/02/24 16:39:04] ppocr INFO:             NormalizeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 mean : [123.675, 116.28, 103.53]
[2023/02/24 16:39:04] ppocr INFO:                 order : hwc
[2023/02/24 16:39:04] ppocr INFO:                 scale : 1
[2023/02/24 16:39:04] ppocr INFO:                 std : [58.395, 57.12, 57.375]
[2023/02/24 16:39:04] ppocr INFO:             ToCHWImage : None
[2023/02/24 16:39:04] ppocr INFO:             KeepKeys : 
[2023/02/24 16:39:04] ppocr INFO:                 keep_keys : ['input_ids', 'bbox', 'attention_mask', 'token_type_ids', 'image', 'labels']
[2023/02/24 16:39:04] ppocr INFO:     loader : 
[2023/02/24 16:39:04] ppocr INFO:         batch_size_per_card : 8
[2023/02/24 16:39:04] ppocr INFO:         drop_last : False
[2023/02/24 16:39:04] ppocr INFO:         num_workers : 4
[2023/02/24 16:39:04] ppocr INFO:         shuffle : False
[2023/02/24 16:39:04] ppocr INFO: Global : 
[2023/02/24 16:39:04] ppocr INFO:     cal_metric_during_train : False
[2023/02/24 16:39:04] ppocr INFO:     epoch_num : 200
[2023/02/24 16:39:04] ppocr INFO:     eval_batch_step : [0, 19]
[2023/02/24 16:39:04] ppocr INFO:     infer_img : ppstructure/docs/kie/input/zh_val_42.jpg
[2023/02/24 16:39:04] ppocr INFO:     kie_det_model_dir : None
[2023/02/24 16:39:04] ppocr INFO:     kie_rec_model_dir : None
[2023/02/24 16:39:04] ppocr INFO:     log_smooth_window : 10
[2023/02/24 16:39:04] ppocr INFO:     print_batch_step : 10
[2023/02/24 16:39:04] ppocr INFO:     save_epoch_step : 2000
[2023/02/24 16:39:04] ppocr INFO:     save_inference_dir : None
[2023/02/24 16:39:04] ppocr INFO:     save_model_dir : ./output/ser_vi_layoutxlm_xfund_zh
[2023/02/24 16:39:04] ppocr INFO:     save_res_path : ./output/ser/xfund_zh/res
[2023/02/24 16:39:04] ppocr INFO:     seed : 2022
[2023/02/24 16:39:04] ppocr INFO:     use_gpu : True
[2023/02/24 16:39:04] ppocr INFO:     use_visualdl : False
[2023/02/24 16:39:04] ppocr INFO: Loss : 
[2023/02/24 16:39:04] ppocr INFO:     key : backbone_out
[2023/02/24 16:39:04] ppocr INFO:     name : VQASerTokenLayoutLMLoss
[2023/02/24 16:39:04] ppocr INFO:     num_classes : 7
[2023/02/24 16:39:04] ppocr INFO: Metric : 
[2023/02/24 16:39:04] ppocr INFO:     main_indicator : hmean
[2023/02/24 16:39:04] ppocr INFO:     name : VQASerTokenMetric
[2023/02/24 16:39:04] ppocr INFO: Optimizer : 
[2023/02/24 16:39:04] ppocr INFO:     beta1 : 0.9
[2023/02/24 16:39:04] ppocr INFO:     beta2 : 0.999
[2023/02/24 16:39:04] ppocr INFO:     lr : 
[2023/02/24 16:39:04] ppocr INFO:         epochs : 200
[2023/02/24 16:39:04] ppocr INFO:         learning_rate : 5e-05
[2023/02/24 16:39:04] ppocr INFO:         name : Linear
[2023/02/24 16:39:04] ppocr INFO:         warmup_epoch : 2
[2023/02/24 16:39:04] ppocr INFO:     name : AdamW
[2023/02/24 16:39:04] ppocr INFO:     regularizer : 
[2023/02/24 16:39:04] ppocr INFO:         factor : 0.0
[2023/02/24 16:39:04] ppocr INFO:         name : L2
[2023/02/24 16:39:04] ppocr INFO: PostProcess : 
[2023/02/24 16:39:04] ppocr INFO:     class_path : train_data/XFUND/class_list_xfun.txt
[2023/02/24 16:39:04] ppocr INFO:     name : VQASerTokenLayoutLMPostProcess
[2023/02/24 16:39:04] ppocr INFO: Train : 
[2023/02/24 16:39:04] ppocr INFO:     dataset : 
[2023/02/24 16:39:04] ppocr INFO:         data_dir : train_data/XFUND/zh_train/image
[2023/02/24 16:39:04] ppocr INFO:         label_file_list : ['train_data/XFUND/zh_train/train.json']
[2023/02/24 16:39:04] ppocr INFO:         name : SimpleDataSet
[2023/02/24 16:39:04] ppocr INFO:         ratio_list : [1.0]
[2023/02/24 16:39:04] ppocr INFO:         transforms : 
[2023/02/24 16:39:04] ppocr INFO:             DecodeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 channel_first : False
[2023/02/24 16:39:04] ppocr INFO:                 img_mode : RGB
[2023/02/24 16:39:04] ppocr INFO:             VQATokenLabelEncode : 
[2023/02/24 16:39:04] ppocr INFO:                 algorithm : LayoutXLM
[2023/02/24 16:39:04] ppocr INFO:                 class_path : train_data/XFUND/class_list_xfun.txt
[2023/02/24 16:39:04] ppocr INFO:                 contains_re : False
[2023/02/24 16:39:04] ppocr INFO:                 order_method : tb-yx
[2023/02/24 16:39:04] ppocr INFO:                 use_textline_bbox_info : True
[2023/02/24 16:39:04] ppocr INFO:             VQATokenPad : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:                 return_attention_mask : True
[2023/02/24 16:39:04] ppocr INFO:             VQASerTokenChunk : 
[2023/02/24 16:39:04] ppocr INFO:                 max_seq_len : 512
[2023/02/24 16:39:04] ppocr INFO:             Resize : 
[2023/02/24 16:39:04] ppocr INFO:                 size : [224, 224]
[2023/02/24 16:39:04] ppocr INFO:             NormalizeImage : 
[2023/02/24 16:39:04] ppocr INFO:                 mean : [123.675, 116.28, 103.53]
[2023/02/24 16:39:04] ppocr INFO:                 order : hwc
[2023/02/24 16:39:04] ppocr INFO:                 scale : 1
[2023/02/24 16:39:04] ppocr INFO:                 std : [58.395, 57.12, 57.375]
[2023/02/24 16:39:04] ppocr INFO:             ToCHWImage : None
[2023/02/24 16:39:04] ppocr INFO:             KeepKeys : 
[2023/02/24 16:39:04] ppocr INFO:                 keep_keys : ['input_ids', 'bbox', 'attention_mask', 'token_type_ids', 'image', 'labels']
[2023/02/24 16:39:04] ppocr INFO:     loader : 
[2023/02/24 16:39:04] ppocr INFO:         batch_size_per_card : 8
[2023/02/24 16:39:04] ppocr INFO:         drop_last : False
[2023/02/24 16:39:04] ppocr INFO:         num_workers : 4
[2023/02/24 16:39:04] ppocr INFO:         shuffle : True
[2023/02/24 16:39:04] ppocr INFO: train with paddle 2.4.0-rc0 and device Place(cpu)
[2023/02/24 16:40:46] ppocr INFO: resume from ./pretrained_model/ser_vi_layoutxlm_xfund_pretrained/best_accuracy
[2023-02-24 16:40:48,561] [    INFO] - Already cached /home/axsae/.paddlenlp/models/layoutxlm-base-uncased/layoutxlm-base-uncased/sentencepiece.bpe.model
[2023-02-24 16:40:49,423] [    INFO] - tokenizer config file saved in /home/axsae/.paddlenlp/models/layoutxlm-base-uncased/layoutxlm-base-uncased/tokenizer_config.json
[2023-02-24 16:40:49,423] [    INFO] - Special tokens file saved in /home/axsae/.paddlenlp/models/layoutxlm-base-uncased/layoutxlm-base-uncased/special_tokens_map.json
[2023/02/24 16:42:03] ppocr INFO: resume from ./pretrained_model/re_vi_layoutxlm_xfund_pretrained/best_accuracy
[2023/02/24 16:42:18] ppocr INFO: process: [0/1], save result to ./output/re/xfund_zh/with_gt/Invoice_ser_re.jpg